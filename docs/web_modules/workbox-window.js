try{self["workbox:window:4.3.1"]&&_()}catch(n){}var w=function(n,o){return new Promise(function(i){var a=new MessageChannel;a.port1.onmessage=function(d){return i(d.data)},n.postMessage(o,[a.port2])})};function L(n,o){for(var i=0;i<o.length;i++){var a=o[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(n,a.key,a)}}function v(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}try{self["workbox:core:4.3.1"]&&_()}catch(n){}var m=function(){var n=this;this.promise=new Promise(function(o,i){n.resolve=o,n.reject=i})},E=function(n,o){return new URL(n,location).href===new URL(o,location).href},l=function(n,o){Object.assign(this,o,{type:n})};function p(n){return function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];try{return Promise.resolve(n.apply(this,o))}catch(a){return Promise.reject(a)}}}function y(n,o,i){return i?o?o(n):n:(n&&n.then||(n=Promise.resolve(n)),o?n.then(o):n)}function k(){}var P=function(n){var o,i;function a(r,s){var e;return s===void 0&&(s={}),(e=n.call(this)||this).t=r,e.i=s,e.o=0,e.u=new m,e.s=new m,e.h=new m,e.v=e.v.bind(v(v(e))),e.l=e.l.bind(v(v(e))),e.g=e.g.bind(v(v(e))),e.m=e.m.bind(v(v(e))),e}i=n,(o=a).prototype=Object.create(i.prototype),o.prototype.constructor=o,o.__proto__=i;var d,b,u=a.prototype;return u.register=p(function(r){var s,e,t=this,h=(r===void 0?{}:r).immediate,g=h!==void 0&&h;return s=function(){return t.p=Boolean(navigator.serviceWorker.controller),t.P=t.R(),y(t.k(),function(c){t.B=c,t.P&&(t.O=t.P,t.s.resolve(t.P),t.h.resolve(t.P),t.j(t.P),t.P.addEventListener("statechange",t.l,{once:!0}));var f=t.B.waiting;return f&&E(f.scriptURL,t.t)&&(t.O=f,Promise.resolve().then(function(){t.dispatchEvent(new l("waiting",{sw:f,wasWaitingBeforeRegister:!0}))})),t.O&&t.u.resolve(t.O),t.B.addEventListener("updatefound",t.g),navigator.serviceWorker.addEventListener("controllerchange",t.m,{once:!0}),"BroadcastChannel"in self&&(t.C=new BroadcastChannel("workbox"),t.C.addEventListener("message",t.v)),navigator.serviceWorker.addEventListener("message",t.v),t.B})},(e=function(){if(!g&&document.readyState!=="complete")return function(c,f){if(!f)return c&&c.then?c.then(k):Promise.resolve()}(new Promise(function(c){return addEventListener("load",c)}))}())&&e.then?e.then(s):s(e)}),u.getSW=p(function(){return this.O||this.u.promise}),u.messageSW=p(function(r){return y(this.getSW(),function(s){return w(s,r)})}),u.R=function(){var r=navigator.serviceWorker.controller;if(r&&E(r.scriptURL,this.t))return r},u.k=p(function(){var r=this;return function(s,e){try{var t=s()}catch(h){return e(h)}return t&&t.then?t.then(void 0,e):t}(function(){return y(navigator.serviceWorker.register(r.t,r.i),function(s){return r.L=performance.now(),s})},function(s){throw s})}),u.j=function(r){w(r,{type:"WINDOW_READY",meta:"workbox-window"})},u.g=function(){var r=this.B.installing;this.o>0||!E(r.scriptURL,this.t)||performance.now()>this.L+6e4?(this.W=r,this.B.removeEventListener("updatefound",this.g)):(this.O=r,this.u.resolve(r)),++this.o,r.addEventListener("statechange",this.l)},u.l=function(r){var s=this,e=r.target,t=e.state,h=e===this.W,g=h?"external":"",c={sw:e,originalEvent:r};!h&&this.p&&(c.isUpdate=!0),this.dispatchEvent(new l(g+t,c)),t==="installed"?this._=setTimeout(function(){t==="installed"&&s.B.waiting===e&&s.dispatchEvent(new l(g+"waiting",c))},200):t==="activating"&&(clearTimeout(this._),h||this.s.resolve(e))},u.m=function(r){var s=this.O;s===navigator.serviceWorker.controller&&(this.dispatchEvent(new l("controlling",{sw:s,originalEvent:r})),this.h.resolve(s))},u.v=function(r){var s=r.data;this.dispatchEvent(new l("message",{data:s,originalEvent:r}))},d=a,(b=[{key:"active",get:function(){return this.s.promise}},{key:"controlling",get:function(){return this.h.promise}}])&&L(d.prototype,b),a}(function(){function n(){this.D={}}var o=n.prototype;return o.addEventListener=function(i,a){this.T(i).add(a)},o.removeEventListener=function(i,a){this.T(i).delete(a)},o.dispatchEvent=function(i){i.target=this,this.T(i.type).forEach(function(a){return a(i)})},o.T=function(i){return this.D[i]=this.D[i]||new Set},n}());export{P as Workbox,w as messageSW};
